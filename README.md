# äºŒç»´ç ç”Ÿæˆå™¨

åŸºäº Taro + React + TypeScript å¼€å‘çš„å¤šç«¯äºŒç»´ç ç”Ÿæˆå°ç¨‹åºï¼Œæ”¯æŒè‡ªå®šä¹‰æ ·å¼ã€æ·»åŠ  Logoã€è®¾ç½®æ ‡ç­¾ç­‰åŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹æ€§

- âœ¨ **å¿«é€Ÿç”Ÿæˆ** - è¾“å…¥å†…å®¹å³å¯ç”ŸæˆäºŒç»´ç 
- ğŸ¨ **è‡ªå®šä¹‰æ ·å¼** - æ”¯æŒè°ƒæ•´å°ºå¯¸ã€é¢œè‰²ã€è¾¹è·
- ğŸ¯ **å¿«æ·é…è‰²** - å†…ç½®ç»å…¸é»‘ã€ç´«è‰²ã€è“è‰²ã€ç»¿è‰²ã€çº¢è‰²ã€æ©™è‰²ã€æ·±è“ç­‰é…è‰²æ–¹æ¡ˆ
- ğŸ–¼ï¸ **æ·»åŠ  Logo** - æ”¯æŒåœ¨äºŒç»´ç ä¸­å¿ƒæ·»åŠ  Logo å›¾ç‰‡
- ğŸ›¡ï¸ **çº é”™çº§åˆ«** - æ”¯æŒ L/M/Q/H å››ç§çº é”™çº§åˆ«
- ğŸ·ï¸ **æ ‡ç­¾è®¾ç½®** - æ”¯æŒåœ¨äºŒç»´ç ä¸Šä¸‹æ–¹æ·»åŠ æ–‡å­—æ ‡ç­¾
- ğŸ’¾ **ä¿å­˜ç›¸å†Œ** - ä¸€é”®ä¿å­˜äºŒç»´ç åˆ°æ‰‹æœºç›¸å†Œ
- ğŸ“± **å¤šç«¯æ”¯æŒ** - æ”¯æŒå¾®ä¿¡å°ç¨‹åºã€H5ã€æ”¯ä»˜å®å°ç¨‹åºç­‰å¤šç«¯

## æŠ€æœ¯æ ˆ

| æŠ€æœ¯                                           | ç‰ˆæœ¬  | è¯´æ˜               |
| ---------------------------------------------- | ----- | ------------------ |
| [Taro](https://taro.zone/)                     | 4.x   | å¤šç«¯å¼€å‘æ¡†æ¶       |
| [React](https://react.dev/)                    | 18.x  | UI æ¡†æ¶            |
| [TypeScript](https://www.typescriptlang.org/)  | 5.x   | ç±»å‹æ”¯æŒ           |
| [Sass](https://sass-lang.com/)                 | -     | CSS é¢„å¤„ç†å™¨       |
| [NutUI](https://nutui.jd.com/taro/react/2x/)   | 2.x   | äº¬ä¸œé£æ ¼ UI ç»„ä»¶åº“ |
| [qrcode](https://www.npmjs.com/package/qrcode) | 1.5.x | äºŒç»´ç ç”Ÿæˆåº“       |

## é¡¹ç›®ç»“æ„

```
qr-generate/
â”œâ”€â”€ config/                 # Taro é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ dev.ts             # å¼€å‘ç¯å¢ƒé…ç½®
â”‚   â”œâ”€â”€ index.ts           # é…ç½®å…¥å£
â”‚   â””â”€â”€ prod.ts            # ç”Ÿäº§ç¯å¢ƒé…ç½®
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ pages/             # é¡µé¢ç›®å½•
â”‚   â”‚   â”œâ”€â”€ generate/      # äºŒç»´ç ç”Ÿæˆé¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ index.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ index.scss
â”‚   â”‚   â”‚   â””â”€â”€ index.config.ts
â”‚   â”‚   â”œâ”€â”€ configure/     # äºŒç»´ç é…ç½®é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ index.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ index.scss
â”‚   â”‚   â”‚   â””â”€â”€ index.config.ts
â”‚   â”‚   â””â”€â”€ index/         # é¦–é¡µï¼ˆé‡å®šå‘ï¼‰
â”‚   â”œâ”€â”€ utils/             # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ qrcode.ts      # äºŒç»´ç ç”Ÿæˆæ ¸å¿ƒé€»è¾‘
â”‚   â”œâ”€â”€ app.ts             # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ app.scss           # å…¨å±€æ ·å¼
â”‚   â””â”€â”€ app.config.ts      # åº”ç”¨é…ç½®
â”œâ”€â”€ types/                  # ç±»å‹å®šä¹‰
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ project.config.json    # å¾®ä¿¡å°ç¨‹åºé…ç½®
```

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js >= 16
- pnpm >= 8ï¼ˆæ¨èï¼‰æˆ– npm

### å®‰è£…ä¾èµ–

```bash
# ä½¿ç”¨ pnpm
pnpm install

# æˆ–ä½¿ç”¨ npm
npm install
```

### å¼€å‘è¿è¡Œ

```bash
# å¾®ä¿¡å°ç¨‹åº
pnpm run dev:weapp

# H5
pnpm run dev:h5

# æ”¯ä»˜å®å°ç¨‹åº
pnpm run dev:alipay

# æŠ–éŸ³å°ç¨‹åº
pnpm run dev:tt

# QQ å°ç¨‹åº
pnpm run dev:qq
```

### æ„å»ºæ‰“åŒ…

```bash
# å¾®ä¿¡å°ç¨‹åº
pnpm run build:weapp

# H5
pnpm run build:h5

# æ”¯ä»˜å®å°ç¨‹åº
pnpm run build:alipay
```

## æ”¯æŒå¹³å°

| å¹³å°         | å¼€å‘å‘½ä»¤       | æ„å»ºå‘½ä»¤         |
| ------------ | -------------- | ---------------- |
| å¾®ä¿¡å°ç¨‹åº   | `dev:weapp`    | `build:weapp`    |
| H5           | `dev:h5`       | `build:h5`       |
| æ”¯ä»˜å®å°ç¨‹åº | `dev:alipay`   | `build:alipay`   |
| æŠ–éŸ³å°ç¨‹åº   | `dev:tt`       | `build:tt`       |
| QQ å°ç¨‹åº    | `dev:qq`       | `build:qq`       |
| äº¬ä¸œå°ç¨‹åº   | `dev:jd`       | `build:jd`       |
| å¿«åº”ç”¨       | `dev:quickapp` | `build:quickapp` |

## é¡µé¢è¯´æ˜

### ç”Ÿæˆé¡µé¢ (`/pages/generate/index`)

- è¾“å…¥è¦ç”ŸæˆäºŒç»´ç çš„å†…å®¹ï¼ˆæ”¯æŒç½‘å€ã€æ–‡æœ¬ã€ç”µè¯å·ç ç­‰ï¼‰
- ç‚¹å‡»"ç”ŸæˆäºŒç»´ç "æŒ‰é’®å¿«é€Ÿç”Ÿæˆ
- é¢„è§ˆç”Ÿæˆçš„äºŒç»´ç 
- ç‚¹å‡»"ä¸‹ä¸€æ­¥"è¿›å…¥é…ç½®é¡µé¢è¿›è¡Œæ›´å¤šè®¾ç½®

### é…ç½®é¡µé¢ (`/pages/configure/index`)

- **å°ºå¯¸è®¾ç½®**ï¼šè°ƒæ•´äºŒç»´ç å¤§å°ï¼ˆ100-300pxï¼‰å’Œè¾¹è·
- **é¢œè‰²è®¾ç½®**ï¼šé€‰æ‹©å¿«æ·é…è‰²æˆ–è‡ªå®šä¹‰å‰æ™¯è‰²/èƒŒæ™¯è‰²
- **Logo è®¾ç½®**ï¼šä¸Šä¼ ä¸­å¿ƒ Logoï¼Œè°ƒæ•´å¤§å°
- **çº é”™çº§åˆ«**ï¼šé€‰æ‹© Lï¼ˆä½ï¼‰/Mï¼ˆä¸­ï¼‰/Qï¼ˆé«˜ï¼‰/Hï¼ˆæœ€é«˜ï¼‰
- **æ ‡ç­¾è®¾ç½®**ï¼šæ·»åŠ ä¸Šä¸‹æ–¹æ–‡å­—æ ‡ç­¾
- **ä¿å­˜ç›¸å†Œ**ï¼šå°†é…ç½®å¥½çš„äºŒç»´ç ä¿å­˜åˆ°æ‰‹æœºç›¸å†Œ

## çº é”™çº§åˆ«è¯´æ˜

| çº§åˆ« | çº é”™èƒ½åŠ› | è¯´æ˜                               |
| ---- | -------- | ---------------------------------- |
| L    | 7%       | é€‚åˆå¹²å‡€ç¯å¢ƒï¼Œæ•°æ®å¯†åº¦æœ€ä½         |
| M    | 15%      | é»˜è®¤çº§åˆ«ï¼Œé€‚åˆä¸€èˆ¬åœºæ™¯             |
| Q    | 25%      | é€‚åˆæœ‰è½»å¾®æ±¡æŸçš„åœºæ™¯               |
| H    | 30%      | æœ€é«˜çº é”™ï¼Œé€‚åˆæ·»åŠ  Logo æˆ–æ¶åŠ£ç¯å¢ƒ |

## æ³¨æ„äº‹é¡¹

1. **çœŸæœºè°ƒè¯•**ï¼šé¡¹ç›®ä½¿ç”¨ Canvas ç»„ä»¶ç»˜åˆ¶äºŒç»´ç ï¼Œè¯·ç¡®ä¿åœ¨çœŸæœºä¸Šæµ‹è¯•
2. **Logo å°ºå¯¸**ï¼šLogo å°ºå¯¸å—çº é”™çº§åˆ«é™åˆ¶ï¼Œçº é”™çº§åˆ«è¶Šé«˜ï¼Œå…è®¸çš„ Logo è¶Šå¤§
3. **ä¿å­˜æƒé™**ï¼šé¦–æ¬¡ä¿å­˜åˆ°ç›¸å†Œéœ€è¦ç”¨æˆ·æˆæƒ
4. **å†…å®¹é•¿åº¦**ï¼šäºŒç»´ç å†…å®¹è¶Šé•¿ï¼ŒäºŒç»´ç è¶Šå¤æ‚ï¼Œå»ºè®®æ§åˆ¶åœ¨ 500 å­—ç¬¦ä»¥å†…

## å¼€å‘è¯´æ˜

### äºŒç»´ç ç”Ÿæˆæ ¸å¿ƒ

äºŒç»´ç ç”Ÿæˆé€»è¾‘ä½äº `src/utils/qrcode.ts`ï¼Œä¸»è¦å¯¼å‡ºä»¥ä¸‹å‡½æ•°ï¼š

```typescript
// ç”Ÿæˆçº¯äºŒç»´ç 
generateQRCodeTempFile(canvasId, text, options, componentInstance);

// ç”Ÿæˆå®Œæ•´äºŒç»´ç ï¼ˆåŒ…å«æ ‡ç­¾å’Œ Logoï¼‰
generateFullQRCodeImage(canvasId, text, options, componentInstance);

// è®¡ç®— Logo æœ€å¤§å°ºå¯¸
calculateMaxLogoSize(qrSize, errorCorrectionLevel);

// è®¡ç®—å®Œæ•´äºŒç»´ç å°ºå¯¸
calculateFullQRCodeSize(qrWidth, topLabel, bottomLabel);
```

### Canvas å…¼å®¹æ€§

é¡¹ç›®ä½¿ç”¨é¡µé¢ Canvas ç»„ä»¶ï¼ˆ`Taro.createCanvasContext`ï¼‰è€Œéç¦»å± Canvasï¼Œä»¥ç¡®ä¿çœŸæœºå…¼å®¹æ€§ã€‚

## License

MIT

## å°ç¨‹åºåœ°å€

![å¾®ä¿¡å°ç¨‹åº](assets/weapp-qrcode.png)

## æˆ‘çš„å…¬ä¼—å·

![å…¬ä¼—å·åœ°å€](assets/wechat-qrcode.jpg)
